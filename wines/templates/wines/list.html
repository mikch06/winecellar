<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8">
    <title>Weindatenbank</title>
    <link rel="stylesheet" href="https://unpkg.com/unpoly@3.6.0/unpoly.min.css">
    <script src="https://unpkg.com/unpoly@3.6.0/unpoly.min.js"></script>
  </head>
  <body>
    <!-- up-main definiert den Hauptbereich, den Unpoly ersetzen darf -->
    <main up-main id="list-content" up-hungry>
      <h2>Weine</h2>

      <a up-layer="new modal" up-href="{% url 'wine_new' %}">
        ➕ Neuer Wein
      </a>

      <table border="1" cellpadding="6">
        <thead>
          <tr>
            <th>Name</th>
            <th>Jahr</th>
            <th>Region</th>
            <th>Rebsorte</th>
            <th>Aktion</th>
          </tr>
        </thead>
        <tbody>
          {% for wine in wines %}
          <tr>
            <td>{{ wine.winename }}</td>
            <td>{{ wine.year }}</td>
            <td>{{ wine.region }}</td>
            <td>{{ wine.grapes }}</td>
            <td>
              <button up-layer="new modal" up-href="{% url 'wine_detail' wine.pk %}">
                Details
              </button>
            </td>
          </tr>
          {% empty %}
          <tr><td colspan="5">Keine Weine vorhanden.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </main>

    <!-- Optional: Modal schließen → Liste reload -->
    <script>
      up.on('up:layer:closed', function(event) {
        if (event.layer.mode === 'modal') {
          up.reload('#list-content');
        }
      });
    </script>
  </body>
</html>