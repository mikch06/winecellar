{% extends "wines/base.html" %}
{% block content %}
<div up-main class="p-4"></div>
<div class="container py-4">
  <h3 class="mb-4">üç∑ Wein-Statistik nach L√§ndern</h3>

  <div style="max-width: 600px; max-height: 600px; margin: 0 auto;">
    <canvas id="countryChart"></canvas>
  </div>
</div>

</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  fetch("{% url 'wine_stats' %}", { headers: { 'X-Requested-With': 'XMLHttpRequest' } })
    .then(response => response.json())
    .then(data => {
      const ctx = document.getElementById("countryChart");
      new Chart(ctx, {
        type: "pie",
        data: {
          labels: data.labels,
          datasets: [{
            label: "Anzahl Flaschen",
            data: data.bottles,
            borderWidth: 1,
            backgroundColor: [
                '#7B1E24', // dunkles Rot (Cabernet)
                '#C0392B', // Bordeaux
                '#D98880', // Ros√©
                '#F5CBA7', // Chardonnay
                '#F9E79F', // Riesling
                '#A9CCE3', // Blau-Ton als Kontrast
                '#4A235A', // Traube
                '#78281F', // Rotwein
                '#7D6608', // Holzfass
                '#117864', // Weinblatt
                '#B9770E', // Korken
                '#5D6D7E', // Schiefer
              ]
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { position: 'top' },
            title: {
              display: true,
              text: 'Flaschen pro Land'
            }
          }
        }
      });
    });
});
</script>
{% endblock %}
